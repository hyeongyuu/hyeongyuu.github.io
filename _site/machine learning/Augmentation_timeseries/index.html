<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Augmentation of Time series data - Hyeongyu.log</title>
<meta name="description" content="Self blog">


  <meta name="author" content="Moon Hyeongyu">
  
  <meta property="article:author" content="Moon Hyeongyu">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="Hyeongyu.log">
<meta property="og:title" content="Augmentation of Time series data">
<meta property="og:url" content="http://localhost:4000/machine%20learning/augmentation_timeseries/">


  <meta property="og:description" content="Self blog">







  <meta property="article:published_time" content="2023-02-25T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/machine%20learning/augmentation_timeseries/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Moon Hyeongyu",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Hyeongyu.log Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/logo.jpg/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/logo.jpg/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/logo.jpg/favicon-16x16.png">
<link rel="mask-icon" href="/assets/images/logo.jpg/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->

    
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Hyeongyu.log
          <span class="site-subtitle"></span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Category</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tag</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Archive</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/bio-photo.jpg" alt="Moon Hyeongyu" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Moon Hyeongyu</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Data Scientist</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Seoul.South Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:hyeongyu.moon@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/hyeongyu-moon-9b7498264/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://github.com/hyeongyuu" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
          
        
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Augmentation of Time series data">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2023-02-25T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/machine%20learning/augmentation_timeseries/" class="u-url" itemprop="url">Augmentation of Time series data
</a>
          </h1>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-bars"></i> content</h4></header>
              <ul class="toc__menu"><li><a href="#시작하며">시작하며</a></li><li><a href="#데이터-증강data-augmentation">데이터 증강(Data augmentation)</a><ul><li><a href="#데이터-증강이란">데이터 증강이란?</a></li><li><a href="#시계열-데이터-증강">시계열 데이터 증강</a></li></ul></li><li><a href="#데이터-증강-기법">데이터 증강 기법</a><ul><li><a href="#1-cropping">1. Cropping</a><ul><li><a href="#time-cropping">Time cropping</a></li><li><a href="#window-cropping">Window cropping</a></li></ul></li><li><a href="#2-warping">2. Warping</a><ul><li><a href="#time-warping">Time warping</a></li><li><a href="#window-warping">Window warping</a></li></ul></li><li><a href="#3-noise-injection">3. Noise injection</a><ul><li><a href="#white-noise-injection">White noise injection</a></li><li><a href="#outlier-injection">Outlier injection</a></li></ul></li></ul></li><li><a href="#마치며">마치며</a></li></ul>

            </nav>
          </aside>
        
        <h2 id="시작하며">시작하며</h2>
<!-- 도입부 -->
<p><strong>시계열 데이터</strong>는 <strong><u>일정한 시간 간격으로 발생하는 시간에 따라 정렬된 데이터</u></strong>를 의미하며, 오늘날 제조, 금융, 의료 등 다양한 분야에서 발생하고 있습니다. 그리고 현업에서 머신러닝(회귀, 분류)을 위한 시계열 데이터는 다른 분야(이미지, 텍스트 등)와 같은 목적으로 활용됩니다.</p>

<p>다른 분야는 웹상에 공유된 데이터도 많고 바로 서비스 적용할 수 있는 수준의 모델도 많아 개발에 어려움이 없지만, 시계열 분야는 <strong>데이터도 별로 없을뿐더러</strong> 분류, 예측 등 목적에 특화된 <strong>모델 개발도 많이 진행되지 못해</strong> 개발에 어려움이 많습니다.</p>

<p>이러한 문제 해결 방법의 하나인 <strong>데이터 부족 문제</strong>를 해결하는 <span style="background-color: #dcffe4"><strong>데이터 증강(Data augmentation)</strong></span>에 대해 알아보고자 합니다.</p>

<h2 id="데이터-증강data-augmentation">데이터 증강(Data augmentation)</h2>
<h3 id="데이터-증강이란">데이터 증강이란?</h3>
<p><strong>데이터 증강</strong>이란 <strong><u>데이터양을 늘리기 위한 기법</u></strong>으로, 보유한 데이터에 여러 변환을 적용하여 데이터 수를 증가시킵니다. Computer Vision 분야에서 필수로 사용되며, 아래 이미지와 같이 원본 이미지를 다양한 방식으로 변환해 원본 데이터에서 학습하지 못했던 부분을 모델이 학습할 수 있도록 합니다.<br /></p>

<p><img src="/assets/images/post_images//woong.png" alt="Woong" /> ➡️ <img src="/assets/images/post_images//woong_augmentation.png" alt="Woong_augmentation" /><br /></p>

<p><strong>데이터 증강</strong>으로 원본 이미지의 고유한 특성(고양이)은 유지한 새로운 이미지(고양이)를 생성하였고, 그 결과 <span style="background-color: #dcffe4">한정적인 훈련 <strong>데이터의 양을 증가</strong>시켜 모델 성능을 높이고 과적합 문제를 해결</span>할 수 있습니다.</p>

<h3 id="시계열-데이터-증강">시계열 데이터 증강</h3>
<p>데이터 증강은 시계열 데이터에도 적용할 수 있습니다. 시계열 데이터의 경우 데이터 수집이 어렵고 비용이 많이 들기 때문에 데이터 증강 기술이 유용하게 활용됩니다.</p>

<p>일반적으로 시간이 지남에 따라 변화하는 시간 축을 가지고 있으므로, <u>증강 기법은 시간 축을 활용하여 데이터를 변형</u>합니다. 시간 축을 <strong>이동하거나(Shift)</strong>, <strong>회전시키거나(Rotation)</strong>, <strong>노이즈를 추가하거나(Noise)</strong>, <strong>일부 구간을 제거하거나(Crop)</strong>, <strong>데이터를 뒤집는(Reverse)</strong> 등의 다양한 기법을 적용할 수 있습니다.</p>

<p>이를 통해 새로운 시계열 데이터를 생성하고 모델 학습에 이용해 데이터의 다양성을 확보하고 성능을 향상시킬 수 있습니다.</p>

<h2 id="데이터-증강-기법">데이터 증강 기법</h2>
<p><strong>시계열 데이터 증강 기법</strong>은 크게 원본 데이터를 <strong><u>단순 변형하는 방법</u></strong>과 <strong><u>생성 모델(Generative model)</u></strong> 개발을 통한 새로운 데이터를 생성하는 방법이 있습니다. 본 포스팅에선 기존 데이터를 <strong>단순 변형하는 방법</strong>에 대해 알아보고, 증강 기법을 코드로 구현 및 시각화 자료로 결과를 확인하고자 합니다.
<img src="/assets/images/post_images//timeseries_augmentation.png" alt="Timeseries augmentation" /></p>

<h3 id="1-cropping">1. Cropping</h3>
<p><strong>Cropping</strong>은 <strong><u>원본 데이터의 일부 구간을 잘라내는 기법</u></strong>입니다. 데이터 일부분을 제거하여 정보 손실이 있지만, 제거한 부분이 원본 데이터에서 불필요한 부분이라면 학습에 최적화된 데이터를 생성 및 활용하는 것으로 볼 수 있습니다. 이처럼 cropping을 통해 원본 데이터의 특징을 도출하고 불필요한 데이터를 제거한 새로운 데이터를 생성합니다.</p>

<h4 id="time-cropping">Time cropping</h4>
<p>전체 구간을 cropping 하는 방법으로 데이터의 시작, 끝부분을 특정 길이만큼 제거합니다. 전체 길이의 cropping 할 percentage를 입력하여 시작, 끝부분에 각각 적용합니다. 그 결과 아래와 같이 불필요한 데이터를 제거할 수 있습니다. 
<img src="/assets/images/post_images//time_cropping.png" alt="Time cropping" /></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">time_crop</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="s">"""
    inputs
        series
            a pandas Series, must have DatetimeIndex
        pct
            a cropping percentage, within interval [0.0, 0.5] (default 0.1)
    output
        series
            a pandas Series with DatetimeIndex
    """</span>
    <span class="n">sr_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sr_len</span><span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pct</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">series</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="o">-</span><span class="n">end</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="window-cropping">Window cropping</h4>
<p>데이터를 일정한 간격으로 cropping 하는 방법으로 데이터 일부분을 제거합니다. 시작, 끝부분만을 제거하는 Time cropping과 다르게 전체적으로 균등하게 데이터를 제거합니다.
<img src="/assets/images/post_images//window_cropping.png" alt="Window cropping" /></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">window_crop</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="s">"""
    inputs
        series
            a pandas Series, must have DatetimeIndex
        freq
            a frequency integer to be used as cropping difference (default 100)
        pct
            a cropping percentage, within interval [0.0, 0.5] (default 0.1)
    output
        series
            a pandas Series with DatetimeIndex
    """</span>
    <span class="n">sr_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sr_len</span><span class="p">)</span>
    <span class="n">crop_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">freq</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pct</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">in_freq</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">((</span><span class="n">freq</span> <span class="o">*</span> <span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">freq</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">crop_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="n">freq</span><span class="p">::</span><span class="n">freq</span><span class="p">])]).</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">out_freq</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">sr_len</span> <span class="o">%</span> <span class="n">freq</span><span class="p">):]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">in_freq</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">series</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
</code></pre></div></div>
<h3 id="2-warping">2. Warping</h3>
<p><strong>Warping</strong>은 <strong><u>원본 데이터의 일부 구간을 압축 또는 확장시키는 기법</u></strong>입니다. 시계열 데이터의 시간 축을 일정한 시간만큼 이동시켜 새로운 데이터를 생성하는 방법으로 모델이 데이터의 시간 축 변동에 대해 잘 학습할 수 있도록 도와줍니다. 예를 들어, 특정 이벤트가 발생한 시점에서 데이터의 패턴이 변화할 수 있습니다. 이러한 패턴을 모델이 잘 학습하기 위해 시간 축을 이동시켜 새로운 변화된 패턴을 생성합니다.</p>
<h4 id="time-warping">Time warping</h4>
<p>전체 구간을 warping 하는 방법으로 전체 데이터를 서로 다른 n개의 데이터로 분할하고, 분할된 데이터를 압축 또는 확장시켜 새로운 데이터를 생성합니다.
<img src="/assets/images/post_images//time_warping.png" alt="Time warping" /></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">CubicSpline</span>

<span class="k">def</span> <span class="nf">time_warping</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">n_warp</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="s">"""
    inputs
        series
            a pandas Series, must have DatetimeIndex
        n_warp
            a number of warping list (default 5)
        pad
            a padding length (default 10)
    output
        series
            a pandas Series with DatetimeIndex
    """</span>
    <span class="k">def</span> <span class="nf">__fit_spline</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="n">spl</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">spl</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
    <span class="n">sr_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">sr_len</span><span class="o">-</span><span class="n">pad</span><span class="p">)</span>
    <span class="n">_ts_points</span><span class="p">,</span> <span class="n">_val_points</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_warp</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_warp</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">_ts_points</span> <span class="o">-</span> <span class="n">_val_points</span><span class="p">)</span><span class="o">&lt;</span><span class="n">pad</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">_ts_points</span><span class="p">,</span> <span class="n">_val_points</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">n_warp</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ts_points</span><span class="p">,</span> <span class="n">val_points</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="n">_ts_points</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">sr_len</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span> <span class="n">np</span><span class="p">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="n">_val_points</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">sr_len</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
    <span class="n">ts</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">series</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">series</span><span class="p">.</span><span class="n">values</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="p">[[</span><span class="n">ts</span><span class="p">[</span><span class="n">ts_points</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">ts_points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span> <span class="n">val</span><span class="p">[</span><span class="n">val_points</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">val_points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ts_points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">__fit_spline</span><span class="p">(</span><span class="n">_ls</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">_ls</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">index</span><span class="o">=</span><span class="n">_ls</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">_ls</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">])</span>
</code></pre></div></div>
<h4 id="window-warping">Window warping</h4>
<p>데이터를 일정한 간격(window)으로 waping 하는 방법입니다. Time warping과는 다르게 전체 데이터를 균등하게 분할 및 warping 하여 상대적으로 변환 효과를 줄여 기존 특성을 최대한 보존하면서 warping을 진행합니다.
<img src="/assets/images/post_images//window_warping.png" alt="Window warping" /></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">window_warping</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="s">"""
    inputs
        series
            a pandas Series, must have DatetimeIndex
        window
            a percentage for window size, within interval [0.0, 0.5] (default 0.2)
    output
        series
            a pandas Series with DatetimeIndex
    """</span>
    <span class="n">sr_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sr_len</span><span class="p">)</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sr_len</span> <span class="o">*</span> <span class="n">window</span><span class="p">)</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="n">freq</span> <span class="o">-</span> <span class="p">(</span><span class="n">sr_len</span> <span class="o">%</span> <span class="n">freq</span><span class="p">))</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span> 
    <span class="n">idx_lst</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">pad</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">pad</span><span class="p">)).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">freq</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">time_warping</span><span class="p">(</span><span class="n">series</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">_ls</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="p">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">_ls</span><span class="p">)]],</span> <span class="n">n_warp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">_ls</span> <span class="ow">in</span> <span class="n">idx_lst</span><span class="p">])</span>
</code></pre></div></div>
<!-- #### Magnitude warping -->
<!-- 추가 작성 -->

<h3 id="3-noise-injection">3. Noise injection</h3>
<p><strong>Noise injection</strong>은 <strong><u>랜덤한 노이즈를 시계열 데이터에 추가하여 데이터를 변형시키는 기법</u></strong>입니다. 노이즈 주입은 모델이 더 다양한 패턴을 학습하도록 하며, 모델을 더욱 강건하게 만드는 효과가 있지만, 너무 많은 노이즈가 추가될 경우 모델의 성능을 저하시킬 수도 있습니다. 따라서 적절한 노이즈 크기와 종류를 선택하는 것이 중요합니다.</p>
<h4 id="white-noise-injection">White noise injection</h4>
<!-- 간단 설명, 코드, 시각화 -->
<p>White noise는 백색잡음으로 불리는 대부분 데이터에서 쉽게 발견되는 노이즈입니다. white noise injection은 원본 데이터 특성은 유지하고 자연적인 노이즈(백색잡음)만 랜덤하게 추가하는 방법입니다.
<img src="/assets/images/post_images//white_noise_injection.png" alt="White noise injection" /></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">white_noise_injection</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="s">"""
    inputs
        series
            a pandas Series, must have DatetimeIndex
        pct
            a percentage of noise injection, within interval [0.0, 1.0] (default 0.1)
    output
        series
            a pandas Series with DatetimeIndex
    """</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">series</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__filter_out_1sigma</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">std</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">arr</span><span class="p">[((</span><span class="n">mu</span> <span class="o">-</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">arr</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">arr</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="p">))]</span>
    <span class="n">sr_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sr_len</span><span class="p">)</span>
    <span class="n">_dif</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">dif</span> <span class="o">=</span> <span class="n">__filter_out_1sigma</span><span class="p">(</span><span class="n">_dif</span><span class="p">)</span>
    <span class="n">_mean</span><span class="p">,</span> <span class="n">_std</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dif</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">std</span><span class="p">(</span><span class="n">dif</span><span class="p">)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sr_len</span> <span class="o">*</span> <span class="n">pct</span><span class="p">))</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">_mean</span><span class="p">,</span> <span class="n">_std</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))[</span><span class="n">pos</span><span class="p">]</span>
    <span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">+=</span> <span class="n">noise</span>
    <span class="k">return</span> <span class="n">temp</span>
</code></pre></div></div>
<h4 id="outlier-injection">Outlier injection</h4>
<!-- 간단 설명, 코드, 시각화 -->
<p>Outlier injection은 원본 데이터에 임의로 이상치(outlier)를 추가하는 방법입니다. 이상 탐지를 위한 데이터를 임의로 생성 및 모델 학습에 활용할 수 있습니다.
<img src="/assets/images/post_images//outlier_injection.png" alt="Outlier injection" /></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">outlier_injection</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="mf">0.005</span><span class="p">):</span>
    <span class="s">"""
    inputs
        series
            a pandas Series, must have DatetimeIndex
        pct
            a percentage of noise injection, within interval [0.0, 1.0] (default 0.005)
    output
        series
            a pandas Series with DatetimeIndex
    """</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">series</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__filter_outlier</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
        <span class="n">outlier</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mf">0.995</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">arr</span><span class="p">[(</span><span class="n">arr</span><span class="o">&gt;=</span><span class="n">outlier</span><span class="p">)]</span>
    <span class="n">sr_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sr_len</span><span class="p">)</span>
    <span class="n">_dif</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">dif</span> <span class="o">=</span> <span class="n">__filter_outlier</span><span class="p">(</span><span class="n">_dif</span><span class="p">)</span>
    <span class="n">_mean</span><span class="p">,</span> <span class="n">_std</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dif</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">std</span><span class="p">(</span><span class="n">dif</span><span class="p">)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sr_len</span> <span class="o">*</span> <span class="n">pct</span><span class="p">))</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">_mean</span><span class="p">,</span> <span class="n">_std</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))[</span><span class="n">pos</span><span class="p">]</span>
    <span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">+=</span> <span class="n">noise</span>
    <span class="k">return</span> <span class="n">temp</span>
</code></pre></div></div>
<!-- ## 데이터 증강 적용 -->
<!-- Use Cases of Time Series Data Augmentation -->
<!-- <!-- ### Improving performance-- -->
<!-- ### Small datasets -->
<!-- ### Imbalanced datasets -->

<!-- ## 데이터 증강 한계 및 과제
1. Data quality issues
여전히 햄스터인가?? -> 증강한 데이터가 원본 데이터의 특성을 유지하고 있는가??
2. Augmentation method selection
3. Computational complexity -->

<h2 id="마치며">마치며</h2>
<!-- 결론 -->
<p>머신러닝에서 <strong>데이터 증강</strong>은 <strong>기존 데이터를 변형시켜 새로운 데이터를 생성하는 기술</strong>입니다. 이를 통해 모델은 다양한 패턴을 학습하고 일반화 능력을 향상시킬 수 있습니다. 또한 <strong>데이터 증강</strong>은 일반적으로 <strong>데이터 크기를 증가</strong>시키는 데 사용되며, <strong>모델 과적합을 방지</strong>하고 <strong>데이터 불균형 문제를 해결</strong>하는 데도 유용합니다.</p>

<p>이번 글에서 <strong>시계열 데이터 증강기법</strong>으로 <strong>단순 변형 방법 3가지(Cropping, Warping, Injection)</strong>를 알아봤습니다. 증강기법을 직접 <u>코드로 구현해보고</u> <u>시각화 결과를 확인하며</u> 쉽게 이해할 수 있었습니다. 아직 실제 모델에 증강한 데이터를 활용해 본 적이 없어 효과를 직접 검증해보진 못했지만, 샘플 데이터로 증강을 진행해보면서 대부분 원본 데이터의 특성은 보존하고 있는 것을 확인했습니다. 이를 통해 시계열 데이터 증강이 모델 고도화에 충분히 유의미한 기술임을 확신할 수 있었습니다.</p>

<p>다음 글에서는 한 단계 나아가 생성 모델을 활용한 데이터 증강, 데이터 증강의 한계 및 과제는 어떤 것들이 있는지 알아보고 작성해보겠습니다.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#machine-learning" class="page__taxonomy-item p-category" rel="tag">Machine learning</a><span class="sep">, </span>
    
      <a href="/tags/#time-series" class="page__taxonomy-item p-category" rel="tag">Time series</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#machine-learning" class="page__taxonomy-item p-category" rel="tag">Machine learning</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time class="dt-published" datetime="2023-02-25T00:00:00+09:00">February 25, 2023</time></p>

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/machine%20learning/ensemble/" class="pagination--pager" title="Ensemble
">이전</a>
    
    
      <a href="/machine%20learning/fixmatch/" class="pagination--pager" title="FixMatch
">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="검색어를 입력하세요..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
          <li><a href="mailto:hyeongyu.moon@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/hyeongyu-moon-9b7498264/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://github.com/hyeongyuu" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Moon Hyeongyu. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/machine%20learning/augmentation_timeseries/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/machine%20learning/augmentation_timeseries"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://hyeongyu.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
